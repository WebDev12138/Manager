webpackJsonp([9],{VC4v:function(t,e,a){var n=a("zfCC");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("22e6b233",n,!0)},lDTA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),i=a.n(n),o=a("woOf"),s=a.n(o),l=a("zL8q"),r=a("mtWM"),c=a.n(r),d={inject:["reload"],data:function(){return{tableList:[],all:[],listLoading:!0,commentLoading:!0,isShowEditVisible:!1,deleteVisible:!1,comment:[],rowId:"",total:0,page:1,commentTotal:0,commentPage:1,pageSize:5,status:[{statusId:1,label:"启用"},{statusId:0,label:"禁用"}],value:"",searchName:"",filterTableDataEnd:[]}},created:function(){this.fetchData(),this.getAllData()},filters:{statusFilter:function(t){return{1:"success",2:"danger"}[t]}},methods:{search:function(){""===this.searchName?(this.filterTableDataEnd=[],this.fetchData()):this.doFilter()},fetchData:function(){var t=this;this.listLoading=!0,c.a.get("http://118.31.102.1:9200/comment/getVideo?pageNum="+this.page+"&pageSize="+this.pageSize).then(function(e){t.total=e.data.total,t.tableList=e.data.list,t.listLoading=!1}).catch(function(e){l.Message.error(e.response.data.message),t.listLoading=!1})},getAllData:function(){var t=this;c.a.get("http://118.31.102.1:9200/comment/getAll").then(function(e){t.all=e.data.list}).catch(function(t){l.Message.error(t.response.data.message)})},doFilter:function(){var t=this;this.filterTableDataEnd=[],""!==this.searchName&&(this.all.forEach(function(e,a){e.partition_name&&e.partition_name.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),e.video_title&&e.video_title.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),e.video_describe&&e.video_describe.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),e.author&&e.author.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),console.log(t.filterTableDataEnd)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd))},clickfun:function(t){console.log(t.target.innerText)},CommentData:function(){var t=this;c.a.get("http://118.31.102.1:9200/comment/getCommentNumber?videoId="+this.rowId).then(function(e){t.commentTotal=e.data}).catch(function(e){l.Message.error(e.response.data.message),t.commentLoading=!1}),c.a.get("http://118.31.102.1:9200/comment/getComment?videoId="+this.rowId+"&pageNum="+this.commentPage+"&pageSize="+this.pageSize).then(function(e){t.comment=e.data.list,t.commentLoading=!1}).catch(function(e){l.Message.error(e.response.data.message),t.commentLoading=!1})},showComment:function(t){this.isShowEditVisible=!0,this.commentLoading=!0,this.rowId=t.id,this.CommentData()},deleteUpdate:function(t){console.log(t),this.deleteVisible=!0,this.temp=s()({},t)},submitDelete:function(){var t=s()({},this.temp);console.log(t),console.log(this.tableList);var e=!0,a=!1,n=void 0;try{for(var o,l=i()(this.tableList);!(e=(o=l.next()).done);e=!0){var r=o.value;if(r.uid===this.temp.uid){var c=this.tableList.indexOf(r);this.tableList.splice(c,1),this.fetchData(),console.log(this.tableList);break}}}catch(t){a=!0,n=t}finally{try{!e&&l.return&&l.return()}finally{if(a)throw n}}this.deleteVisible=!1,this.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})},handleModifyStatus:function(t,e){var a=this;c.a.post("http://118.31.102.1:9200/comment/manage",{commentId:t.id,forbidden:e}).then(function(){if(t.forbidden=e,a.$message({message:"操作成功",type:"success"}),t.children&&t.children.length>0)for(var n=0;n<t.children.length;n++)t.children[n].forbidden=e}).catch(function(t){l.Message.error(t.response.data.message),a.deleteVisible=!1})},updateData:function(){this.isShowEditVisible=!1,this.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})},handleSizeChange:function(t){this.page=t,console.log(this.page),this.fetchData()},handleCurrentChange:function(t){this.page=t,console.log(this.page),this.filterTableDataEnd.length<=0?this.fetchData():this.currentChangePage(this.filterTableDataEnd)},handleCommentSizeChange:function(t){this.commentPage=t,console.log(this.commentPage),this.CommentData()},handleCommentCurrentChange:function(t){this.commentPage=t,console.log(this.commentPage),this.CommentData()},currentChangePage:function(t){var e=(this.page-1)*this.pageSize,a=this.page*this.pageSize;for(this.tableList=[];e<a;e++)t[e]&&this.tableList.push(t[e])}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"分区,视频标题,视频描述,作者",clearable:""},on:{change:t.search},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.doFilter()}}},[a("i",{staticClass:"el-icon-search"}),t._v("搜索")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableList,border:"","element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{prop:"partition_name",label:"分区名","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"video_title",label:"视频标题","min-width":"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"video_describe","min-width":"150px",label:"视频描述"}}),t._v(" "),a("el-table-column",{attrs:{prop:"author",label:"作者","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_date",label:"创建时间","min-width":"110px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作 "},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.showComment(e.row)}}},[t._v("查看评论")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, prev, pager, next",background:"","page-size":5,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"评论",visible:t.isShowEditVisible},on:{"update:visible":function(e){t.isShowEditVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.comment}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.children?a("div",[e.row.children.length>0?a("div",{staticClass:"two-huifu"},t._l(e.row.children,function(n){return a("ul",{key:n.id,staticClass:"box twobox"},[a("li",{staticClass:"right"},[a("div",[a("span",{staticClass:"author"},[t._v(t._s(n.author)+":")]),t._v(" "),a("span",{staticClass:"content"},[t._v(t._s(n.comment_content))]),t._v(" "),a("div",{staticClass:"huifu-btn"},["1"===n.forbidden&&"0"===e.row.forbidden?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.handleModifyStatus(n,"0")}}},[t._v("启用\n                    ")]):t._e(),t._v(" "),"0"===n.forbidden?a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleModifyStatus(n,"1")}}},[t._v("禁用\n                    ")]):t._e()],1)]),t._v(" "),a("div",[a("span",{staticClass:"comments"},[t._v("点赞数:"+t._s(n.comments))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(n.created_date))])])])])}),0):t._e()]):t._e(),t._v(" "),0===e.row.children.length?a("div",[a("span",{staticClass:"noContent"},[t._v("暂无评论")])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"comment_content",label:"评论内容","min-width":"150px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"author",label:"作者","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"comments",label:"点赞数","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_date",label:"创建时间","min-width":"80px"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作 "},scopedSlots:t._u([{key:"default",fn:function(e){return["1"===e.row.forbidden?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.handleModifyStatus(e.row,"0")}}},[t._v("启用\n        ")]):t._e(),t._v(" "),"0"===e.row.forbidden?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleModifyStatus(e.row,"1")}}},[t._v("禁用\n        ")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, prev, pager, next",background:"","page-size":5,total:t.commentTotal},on:{"size-change":t.handleCommentSizeChange,"current-change":t.handleCommentCurrentChange}})],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,h,!1,function(t){a("VC4v")},"data-v-bc6e4d96",null);e.default=m.exports},zfCC:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.demo-table-expand[data-v-bc6e4d96] {\n  font-size: 0;\n}\n.demo-table-expand label[data-v-bc6e4d96] {\n  width: 90px;\n  color: #99a9bf;\n}\n.demo-table-expand .el-form-item[data-v-bc6e4d96] {\n  margin-right: 0;\n  margin-bottom: 0;\n  width: 50%;\n}\n.two-huifu[data-v-bc6e4d96] {\n  margin: 10px 0;\n}\n.two-huifu .right[data-v-bc6e4d96] {\n    width: 90%;\n}\n.twobox[data-v-bc6e4d96] {\n  overflow: hidden;\n  margin-left: 32px;\n  background: #eaeaec;\n  padding: 10px;\n  border-bottom: solid 1px #d9d9d9;\n  margin-bottom: 0;\n}\n.twobox[data-v-bc6e4d96]:last-child {\n  border: 0;\n}\n.huifu-btn[data-v-bc6e4d96] {\n  float: right;\n}\n.time[data-v-bc6e4d96] {\n  color: #808080;\n  font-size: 12px;\n}\n.comments[data-v-bc6e4d96] {\n  float: right;\n  color: #808080;\n  font-size: 12px;\n}\n.noContent[data-v-bc6e4d96] {\n  color: #808080;\n  font-size: 12px;\n}\n.dyn-huifu[data-v-bc6e4d96] {\n  padding-top: 15px;\n  border-top: solid 1px #d9d9d9;\n}\n",""])}});