webpackJsonp([21],{fZNS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),l=a.n(i),s=a("woOf"),n=a.n(s),r=a("zL8q"),o=a("mtWM"),d=a.n(o),c={inject:["reload"],data:function(){return{rules:{picture:[{required:!0,message:"头像不可为空",trigger:"blur"}],sex:[{required:!0,message:"性别不可为空",trigger:"blur"}],phone:[{required:!0,message:"手机号不可为空",trigger:"blur"},{min:11,max:11,message:"长度必须是 11 个字符",trigger:"blur"}],email:[{required:!0,message:"邮箱不可为空",trigger:"blur"}]},tableList:[],all:[],listLoading:!0,isShowEditVisible:!1,isShowPassVisible:!1,deleteVisible:!1,temp:{id:"",user_name:"",real_name:"",picture:"",forbidden:""},detail:{id:"",user_name:"",password:"",real_name:"",sex:"",picture:"",phone:"",email:""},pass:{id:"",sex:"",phone:"",email:"",picture:""},total:0,page:1,pageSize:5,status:[{statusId:"启用",label:"启用"},{statusId:"禁用",label:"禁用"}],value:"",searchName:"",filterTableDataEnd:[]}},created:function(){this.fetchData(),this.getAllData()},filters:{statusFilter:function(e){return{1:"success",2:"danger"}[e]}},methods:{search:function(){var e=this;if(""===this.searchName)""!==this.value?this.statusSearch():(this.filterTableDataEnd=[],this.fetchData());else if(""===this.value)this.doFilter();else{this.filterTableDataEnd=[],this.all.forEach(function(t,a){("启用"===e.value&&"1"===t.forbidden||"禁用"===e.value&&"0"===t.forbidden)&&e.filterTableDataEnd.push(t)});var t=this.filterTableDataEnd;this.filterTableDataEnd=[],t.forEach(function(t,a){t.id&&t.id.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t),t.user_name&&t.user_name.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t),t.real_name&&t.real_name.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd)}},statusSearch:function(){var e=this;if(""===this.value)this.search();else if(this.filterTableDataEnd.length<=0||""===this.searchName)this.filterTableDataEnd=[],this.all.forEach(function(t,a){("启用"===e.value&&"1"===t.forbidden||"禁用"===e.value&&"0"===t.forbidden)&&e.filterTableDataEnd.push(t)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd);else{var t=this.filterTableDataEnd;this.filterTableDataEnd=[],t.forEach(function(t,a){("启用"===e.value&&"1"===t.forbidden||"禁用"===e.value&&"0"===t.forbidden)&&e.filterTableDataEnd.push(t)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd)}},fetchData:function(){var e=this;this.listLoading=!0,d.a.get("http://118.31.102.1:9200/managerUser/getManagerUser?pageNum="+this.page+"&pageSize="+this.pageSize).then(function(t){e.total=t.data.total,e.tableList=t.data.list,e.listLoading=!1}).catch(function(t){r.Message.error(t.response.data.message),e.listLoading=!1})},getAllData:function(){var e=this;d.a.get("http://118.31.102.1:9200/managerUser/getAllManager").then(function(t){e.all=t.data}).catch(function(e){r.Message.error(e.response.data.message)})},doFilter:function(){var e=this;this.filterTableDataEnd=[],""!==this.searchName?(this.all.forEach(function(t,a){t.id&&t.id.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t),t.user_name&&t.user_name.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t),t.real_name&&t.real_name.indexOf(e.searchName)>=0&&e.filterTableDataEnd.push(t)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd)):this.fetchData()},clickfun:function(e){console.log(e.target.innerText)},handleUpdate:function(e){var t=this;this.isShowEditVisible=!0,d.a.get("http://118.31.102.1:9200/managerUser/getManagerUserDetail?managerId="+e.id).then(function(e){t.detail=n()({},e.data)}).catch(function(e){r.Message.error(e.response.data.message),t.deleteVisible=!1})},deleteUpdate:function(e){console.log(e),this.deleteVisible=!0,this.temp=n()({},e)},submitDelete:function(){var e=n()({},this.temp);console.log(e),console.log(this.tableList);var t=!0,a=!1,i=void 0;try{for(var s,r=l()(this.tableList);!(t=(s=r.next()).done);t=!0){var o=s.value;if(o.uid===this.temp.uid){var d=this.tableList.indexOf(o);this.tableList.splice(d,1),this.fetchData(),console.log(this.tableList);break}}}catch(e){a=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw i}}this.deleteVisible=!1,this.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})},handleModifyStatus:function(e,t){var a=this;d.a.post("http://118.31.102.1:9200/managerUser/manage",{managerId:e.id,forbidden:t}).then(function(){e.forbidden=t,a.$message({message:"操作成功",type:"success"}),a.reload()}).catch(function(e){r.Message.error(e.response.data.message),a.deleteVisible=!1})},handlePass:function(){this.isShowEditVisible=!1,this.isShowPassVisible=!0,this.pass=this.detail},handleCancel:function(){this.isShowPassVisible=!1,this.isShowEditVisible=!0},updateData:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;d.a.post("http://118.31.102.1:9200/managerUser/editManagerInfo",t.pass).then(function(){t.isShowPassVisible=!1,t.$notify({title:"成功",message:"审核成功",type:"success",duration:2e3}),t.reload()}).catch(function(e){r.Message.error(e.response.data.message)})})},handleSizeChange:function(e){this.page=e,console.log(this.page),this.fetchData()},handleCurrentChange:function(e){this.page=e,console.log(this.page),this.filterTableDataEnd.length<=0?this.fetchData():this.currentChangePage(this.filterTableDataEnd)},currentChangePage:function(e){var t=(this.page-1)*this.pageSize,a=this.page*this.pageSize;for(this.tableList=[];t<a;t++)e[t]&&this.tableList.push(e[t])}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-select",{attrs:{clearable:"",placeholder:"状态"},on:{change:e.statusSearch},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.status,function(e){return a("el-option",{key:e.statusId,attrs:{label:e.label,value:e.statusId}})}),1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"管理员ID,用户名,真实姓名",clearable:""},on:{change:e.search},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doFilter()}}},[a("i",{staticClass:"el-icon-search"}),e._v("搜索")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableList,border:"","element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"160px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"用户名","min-width":"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"real_name","min-width":"100px",label:"真实姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"picture",label:"头像路径","min-width":"150px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作 "},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("查看详细信息")]),e._v(" "),"1"===t.row.forbidden?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return e.handleModifyStatus(t.row,"0")}}},[e._v("启用\n        ")]):e._e(),e._v(" "),"0"===t.row.forbidden?a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleModifyStatus(t.row,"1")}}},[e._v("禁用\n        ")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, prev, pager, next",background:"","page-size":5,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"详细信息",visible:e.isShowEditVisible},on:{"update:visible":function(t){e.isShowEditVisible=t}}},[a("el-form",{attrs:{"label-width":"80px",model:e.detail}},[a("el-form-item",{attrs:{label:"ID",hidden:""}},[a("el-input",{model:{value:e.detail.id,callback:function(t){e.$set(e.detail,"id",t)},expression:"detail.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"头像"}},[a("img",{staticStyle:{width:"5rem",height:"5rem"},attrs:{src:"http://q00p4epjw.bkt.clouddn.com/"+this.detail.picture}})]),e._v(" "),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.detail.user_name,callback:function(t){e.$set(e.detail,"user_name",t)},expression:"detail.user_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.detail.real_name,callback:function(t){e.$set(e.detail,"real_name",t)},expression:"detail.real_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-input",{attrs:{readonly:""},model:{value:e.detail.sex,callback:function(t){e.$set(e.detail,"sex",t)},expression:"detail.sex"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{attrs:{readonly:""},model:{value:e.detail.phone,callback:function(t){e.$set(e.detail,"phone",t)},expression:"detail.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{attrs:{readonly:""},model:{value:e.detail.email,callback:function(t){e.$set(e.detail,"email",t)},expression:"detail.email"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isShowEditVisible=!1}}},[e._v("关闭")]),e._v(" "),a("el-button",{staticClass:"title1",attrs:{type:"primary",loading:e.listLoading},on:{click:e.handlePass}},[e._v("审核")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"审核信息",visible:e.isShowPassVisible},on:{"update:visible":function(t){e.isShowPassVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{"label-width":"80px",model:e.pass,rules:e.rules}},[a("el-form-item",{attrs:{label:"ID",hidden:""}},[a("el-input",{model:{value:e.pass.id,callback:function(t){e.$set(e.pass,"id",t)},expression:"pass.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"头像",prop:"picture"}},[a("img",{staticStyle:{width:"5rem",height:"5rem"},attrs:{src:"http://q00p4epjw.bkt.clouddn.com/"+this.detail.picture}}),e._v(" "),a("el-button",{on:{click:function(t){e.pass.picture="image/picture/default.jpg"}}},[e._v("默认")])],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.pass.sex,callback:function(t){e.$set(e.pass,"sex",t)},expression:"pass.sex"}},[a("el-radio",{attrs:{label:"男"}}),e._v(" "),a("el-radio",{attrs:{label:"女"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{model:{value:e.pass.phone,callback:function(t){e.$set(e.pass,"phone",t)},expression:"pass.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.pass.email,callback:function(t){e.$set(e.pass,"email",t)},expression:"pass.email"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"title1",attrs:{type:"primary",loading:e.listLoading},on:{click:function(t){return e.updateData("dataForm")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]},u=a("VU/8")(c,h,!1,null,null,null);t.default=u.exports}});