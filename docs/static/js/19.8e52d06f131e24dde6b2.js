webpackJsonp([19],{SRSp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),n=a.n(i),l=a("mtWM"),o=a.n(l),s=a("zL8q"),r={inject:["reload"],data:function(){return{addRules:{partition_name:[{required:!0,message:"分区名不可为空",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},updateRules:{partition_name:[{required:!0,message:"分区名不可为空",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}]},changeEditRules:{partition_name:[{required:!0,message:"分区名不可为空",trigger:"blur"}]},tableList:[],all:[],listLoading:!0,Loading:!0,isShowAddVisible:!1,isShowUpdateVisible:!1,isShowChangeVisible:!1,isShowChangeEditVisible:!1,deleteVisible:!1,video:[],add:{partition_name:""},update:{id:"",partition_name:""},delete:{id:""},changeEdit:{id:"",video_title:"",partition_name:"",partitionId:""},rowId:"",total:0,page:1,pageSize:5,videoPage:1,videoPageSize:5,videoTotal:0,status:[{statusId:1,label:"启用"},{statusId:0,label:"禁用"}],value:"",searchName:"",filterTableDataEnd:[]}},created:function(){this.fetchData(),this.getAllData()},filters:{statusFilter:function(t){return{1:"success",2:"danger"}[t]}},methods:{search:function(){""===this.searchName?(this.filterTableDataEnd=[],this.fetchData()):this.doFilter()},fetchData:function(){var t=this;this.listLoading=!0,o.a.get("http://118.31.102.1:9200/partition/?pageNum="+this.page+"&pageSize="+this.pageSize).then(function(e){t.total=e.data.total,t.tableList=e.data.list,t.listLoading=!1}).catch(function(e){s.Message.error(e.response.data.message),t.listLoading=!1})},getAllData:function(){var t=this;o.a.get("http://118.31.102.1:9200/partition/getAll").then(function(e){t.all=e.data}).catch(function(t){s.Message.error(t.response.data.message)})},doFilter:function(){var t=this;this.filterTableDataEnd=[],""!==this.searchName?(this.all.forEach(function(e,a){e.id&&e.id.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),e.partition_name&&e.partition_name.indexOf(t.searchName)>=0&&t.filterTableDataEnd.push(e),console.log(t.filterTableDataEnd)}),this.total=this.filterTableDataEnd.length,this.currentChangePage(this.filterTableDataEnd)):this.fetchData()},clickfun:function(t){console.log(t.target.innerText)},handleUpdate:function(t){this.isShowUpdateVisible=!0,this.update=n()({},t)},VideoData:function(){var t=this;o.a.get("http://118.31.102.1:9200/partition/getVideoInDeletePartition?partitionId="+this.rowId+"&pageNum="+this.videoPage+"&pageSize="+this.videoPageSize).then(function(e){t.videoTotal=e.data.total,t.video=e.data.list,t.Loading=!1}).catch(function(e){s.Message.error(e.response.data.message),t.Loading=!1})},deleteUpdate:function(t){var e=this;o.a.get("http://118.31.102.1:9200/partition/getVideoNumber?partitionId="+t.id).then(function(a){a.data>0?(e.isShowChangeVisible=!0,e.Loading=!0,e.rowId=t.id,e.VideoData()):(e.deleteVisible=!0,e.delete=n()({},t))}).catch(function(t){s.Message.error(t.response.data.message)})},submitDelete:function(){var t=this;o.a.delete("http://118.31.102.1:9200/partition/delete?partitionId="+this.delete.id).then(function(){t.deleteVisible=!1,t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),t.reload()}).catch(function(e){s.Message.error(e.response.data.message),t.deleteVisible=!1})},handleCancel:function(){this.isShowChangeEditVisible=!1,this.isShowChangeVisible=!0},handleChange:function(t){this.isShowChangeVisible=!1,this.isShowChangeEditVisible=!0,this.changeEdit=n()({},t)},handleModifyStatus:function(t,e){this.$message({message:"操作成功",type:"success"}),console.log(t),t.status=e},addData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;o.a.post("http://118.31.102.1:9200/partition/add",e.add).then(function(){e.isShowAddVisible=!1,e.$notify({title:"成功",message:"新增成功",type:"success",duration:2e3}),e.reload()}).catch(function(t){s.Message.error(t.response.data.message)})})},updateData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;o.a.post("http://118.31.102.1:9200/partition/update",e.update).then(function(){e.isShowUpdateVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.reload()}).catch(function(t){s.Message.error(t.response.data.message)})})},updateVideoData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;o.a.post("http://118.31.102.1:9200/partition/editVideo",{partitionId:e.changeEdit.partition_name,videoId:e.changeEdit.id}).then(function(){e.isShowChangeEditVisible=!1,e.$notify({title:"成功",message:"设置成功",type:"success",duration:2e3}),e.reload()}).catch(function(t){s.Message.error(t.response.data.message)})})},handleSizeChange:function(t){this.page=t,console.log(this.page),this.fetchData()},handleCurrentChange:function(t){this.page=t,console.log(this.page),this.filterTableDataEnd.length<=0?this.fetchData():this.currentChangePage(this.filterTableDataEnd)},handleVideoSizeChange:function(t){this.videoPage=t,console.log(this.videoPage),this.VideoData()},handleVideoCurrentChange:function(t){this.videoPage=t,console.log(this.videoPage),this.VideoData()},currentChangePage:function(t){var e=(this.page-1)*this.pageSize,a=this.page*this.pageSize;for(this.tableList=[];e<a;e++)t[e]&&this.tableList.push(t[e])}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"分区ID,分区名",clearable:""},on:{change:t.search},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.doFilter()}}},[a("i",{staticClass:"el-icon-search"}),t._v("搜索")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowAddVisible=!0}}},[t._v("新增")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableList,border:"","element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"200px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"partition_name","min-width":"150px",label:"分区名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作 "},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return t.deleteUpdate(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, prev, pager, next",background:"","page-size":5,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"新增分区",visible:t.isShowAddVisible},on:{"update:visible":function(e){t.isShowAddVisible=e}}},[a("el-form",{ref:"addForm",attrs:{"label-width":"80px",model:t.add,rules:t.addRules}},[a("el-form-item",{attrs:{label:"分区名",prop:"partition_name"}},[a("el-input",{model:{value:t.add.partition_name,callback:function(e){t.$set(t.add,"partition_name",e)},expression:"add.partition_name"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.isShowAddVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"title1",attrs:{type:"primary",loading:t.listLoading},on:{click:function(e){return t.addData("addForm")}}},[t._v("确定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑分区",visible:t.isShowUpdateVisible},on:{"update:visible":function(e){t.isShowUpdateVisible=e}}},[a("el-form",{ref:"updateForm",attrs:{"label-width":"80px",model:t.update,rules:t.updateRules}},[a("el-form-item",{attrs:{label:"ID",hidden:""}},[a("el-input",{model:{value:t.update.id,callback:function(e){t.$set(t.update,"id",e)},expression:"update.id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分区名",prop:"partition_name"}},[a("el-input",{model:{value:t.update.partition_name,callback:function(e){t.$set(t.update,"partition_name",e)},expression:"update.partition_name"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.isShowUpdateVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"title1",attrs:{type:"primary",loading:t.listLoading},on:{click:function(e){return t.updateData("updateForm")}}},[t._v("确定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"分区视频",visible:t.isShowChangeVisible},on:{"update:visible":function(e){t.isShowChangeVisible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.Loading,expression:"Loading"}],staticStyle:{width:"100%"},attrs:{data:t.video,border:"","element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{prop:"partition_name",label:"分区名","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"video_title",label:"视频标题","min-width":"100px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"video_describe","min-width":"120px",label:"视频描述"}}),t._v(" "),a("el-table-column",{attrs:{prop:"author",label:"作者","min-width":"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_date",label:"创建时间","min-width":"90px"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作 "},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.handleChange(e.row)}}},[t._v("编辑分区")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{layout:"total, prev, pager, next",background:"","page-size":5,total:t.videoTotal},on:{"size-change":t.handleVideoSizeChange,"current-change":t.handleVideoCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:"编辑视频分区",visible:t.isShowChangeEditVisible},on:{"update:visible":function(e){t.isShowChangeEditVisible=e}}},[a("el-form",{ref:"changeEditForm",attrs:{"label-width":"80px",model:t.changeEdit,rules:t.changeEditRules}},[a("el-form-item",{attrs:{label:"ID",hidden:""}},[a("el-input",{model:{value:t.changeEdit.id,callback:function(e){t.$set(t.changeEdit,"id",e)},expression:"changeEdit.id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"视频标题"}},[a("el-input",{attrs:{readonly:""},model:{value:t.changeEdit.video_title,callback:function(e){t.$set(t.changeEdit,"video_title",e)},expression:"changeEdit.video_title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分区名",prop:"partition_name"}},[a("el-select",{attrs:{placeholder:"分区"},model:{value:t.changeEdit.partition_name,callback:function(e){t.$set(t.changeEdit,"partition_name",e)},expression:"changeEdit.partition_name"}},t._l(t.tableList,function(t){return a("el-option",{key:t.id,attrs:{label:t.partition_name,value:t.id}})}),1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"title1",attrs:{type:"primary",loading:t.listLoading},on:{click:function(e){return t.updateVideoData("changeEditForm")}}},[t._v("确定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"删除",visible:t.deleteVisible,width:"30%"},on:{"update:visible":function(e){t.deleteVisible=e}}},[a("span",[t._v("确认删除吗")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.deleteVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitDelete}},[t._v("确 定")])],1)])],1)},staticRenderFns:[]},c=a("VU/8")(r,d,!1,null,null,null);e.default=c.exports}});